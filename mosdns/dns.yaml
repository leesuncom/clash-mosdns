plugins:
  ################ DNS #################
  # google doh dot h3（代理用）
  - tag: google
    type: forward
    args:
      concurrent: 3
      upstreams:
        - addr: "https://dns.google/dns-query"
          dial_addr: "8.8.4.4"
        - addr: "https://dns.google/dns-query"
          dial_addr: "8.8.8.8"
        - addr: "tls://dns.google"
          dial_addr: "8.8.4.4"
        - addr: "tls://dns.google"
          dial_addr: "8.8.8.8"
        - addr: "https://dns.google/dns-query"
          dial_addr: "8.8.4.4"
          enable_http3: true
        - addr: "https://dns.google/dns-query"
          dial_addr: "8.8.8.8"
          enable_http3: true

  # cloudflare doh dot h3（代理备用）
  - tag: cloudflare
    type: forward
    args:
      concurrent: 2
      upstreams:
        - addr: "tls://1.1.1.1"
          dial_addr: "1.1.1.1"
        - addr: "tls://1.1.1.1"
          dial_addr: "1.1.1.1"

  # 查询gfw网站时使用（代理）
  - tag: forward_remote
    type: forward
    args:
      upstreams:
        - addr: "udp://127.0.0.1:5353"
          enable_pipeline: true

  # 国外代理主DNS
  - tag: self_hosted
    type: forward
    args:
      upstreams:
        - addr: "udp://127.0.0.1:5353"
          enable_pipeline: true

  # 国内主DNS：阿里DNS（强化可用性）
  - tag: ali
    type: forward
    args:
      concurrent: 3
      upstreams:
        - addr: "https://doh.pub/dns-query"
          dial_addr: "1.12.12.12"
        - addr: "https://doh.pub/dns-query"
          dial_addr: "120.53.53.53"
        - addr: "tls://dot.pub"
          dial_addr: "120.53.53.53"

  # 国内备用DNS：DNSPod
  - tag: dnspod
    type: forward
    args:
      concurrent: 3
      upstreams:
        - addr: "https://doh.pub/dns-query"
          dial_addr: "1.12.12.12"
        - addr: "https://doh.pub/dns-query"
          dial_addr: "120.53.53.53"
        - addr: "tls://dot.pub"
          dial_addr: "120.53.53.53"

  # local dns（局域网）
  - tag: local
    type: forward
    args:
      concurrent: 1
      upstreams:
        - addr: "udp://127.0.0.1:53"

  - tag: self_host
    type: forward
    args:
      concurrent: 1
      upstreams:
        - addr: "udp://127.0.0.1:53"

  # 拒绝响应相关
  - tag: reject_2
    type: sequence
    args:
      - exec: reject 2

  - tag: reject_3
    type: sequence
    args:
      - exec: reject 3

  - tag: reject_5
    type: sequence
    args:
      - exec: reject 5

  - tag: blackhole
    type: sequence
    args:
      - exec: black_hole 127.0.0.1 ::1 0.0.0.0